CREATE TABLE AGENCIA(
	ID_AGENCIA INT PRIMARY KEY NOT NULL,
	CIDADE VARCHAR(100),
	ESTADO CHAR(2)
)

CREATE TABLE FUNCIONARIO(
	ID_FUNCIONARIO INT PRIMARY KEY NOT NULL,
	ID_AGENCIA INT NOT NULL, -- FK
	CPF VARCHAR(14) UNIQUE NOT NULL,
	NOME VARCHAR(100),
	ESTADO CHAR(2),
	CIDADE VARCHAR(100),
	BAIRRO VARCHAR(50),
	RUA VARCHAR(50),
	NUMERO INT, --TALVEZ VARCHAR
	CEP VARCHAR(9),
	SALARIO MONEY
)

CREATE TABLE CLIENTE(
	ID_CLIENTE INT PRIMARY KEY NOT NULL,
	ID_AGENCIA INT NOT NULL, --FK
	ID_CONTA INT NOT NULL, --FK
	CPF VARCHAR(14) UNIQUE NOT NULL,
	NOME VARCHAR(100),
	ESTADO CHAR(2),
	CIDADE VARCHAR(100),
	BAIRRO VARCHAR(50),
	RUA VARCHAR(50),
	NUMERO INT, --TALVEZ VARCHAR
	CEP VARCHAR(9)
)

CREATE TABLE CONTA(
	ID_CONTA INT PRIMARY KEY NOT NULL,
	ID_CLIENTE INT NOT NULL, --FK
	SALDO MONEY
)

CREATE TABLE TRANSACAO(
	NUMERO_TRANSACAO INT PRIMARY KEY NOT NULL,
	ID_CONTA INT NOT NULL,
	DATA_TRANSACAO DATE,
	VALOR MONEY
)



-- CHAVE ESTRANGEIRA DE AGENCIA NA TABELA FUNCIONARIO --DDL 1
ALTER TABLE FUNCIONARIO ADD CONSTRAINT CHAVE_AGENCIA FOREIGN KEY (ID_AGENCIA) REFERENCES AGENCIA (ID_AGENCIA)

-- CHAVE ESTRANGEIRA DE AGENCIA NA TABELA CLIENTE --DDL 2
ALTER TABLE CLIENTE ADD CONSTRAINT CHAVE_AGENCIA FOREIGN KEY (ID_AGENCIA) REFERENCES AGENCIA (ID_AGENCIA)

-- CHAVE ESTRANGEIRA DE CONTA NA TABELA CLIENTE --DDL 3
ALTER TABLE CLIENTE ADD CONSTRAINT CHAVE_CONTA FOREIGN KEY (ID_CONTA) REFERENCES CONTA (ID_CONTA)

-- CHAVE ESTRANGEIRA DE CLIENTE NA TABELA CONTA --DDL 4
ALTER TABLE CONTA ADD CONSTRAINT CHAVE_CLIENTE2 FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (ID_CLIENTE)

-- CHAVE ESTRANGEIRA DE CONTA NA TABELA TRANSACAO --DDL 5
ALTER TABLE TRANSACAO ADD CONSTRAINT CHAVE_CONTA FOREIGN KEY (ID_CONTA) REFERENCES CONTA (ID_CONTA)

INSERT INTO AGENCIA VALUES (0001,'SOROCABA','SP')
INSERT INTO AGENCIA VALUES (0002,'VOTORANTIM','SP')
INSERT INTO AGENCIA VALUES (0003,'PIEDADE','SP')
INSERT INTO AGENCIA VALUES (0004,'TATUI','SP')
INSERT INTO AGENCIA VALUES (0005,'ITU','SP')

INSERT INTO FUNCIONARIO VALUES (0001,0005,'319.408.673-12','Elisa Rosa Jesus','SP','ITU','Parque Nossa Senhora da Candelária','Praça Ângelo Antônio Armênio',33,'13310-189','R$1.500.00')
INSERT INTO FUNCIONARIO VALUES (0002,0004,'621.139.576-04','Kevin Roberto da Conceição','SP','TATUI','Europark','Rua Aparecida Cândia Camargo',123,'18279-668','R$1.000.00')
INSERT INTO FUNCIONARIO VALUES (0003,0003,'348.886.203-85','Sueli Isis Moraes','SP','PIEDADE','Centro','Avenida General Waldomiro de Lima',116,'18170-970','R$2.500.00')
INSERT INTO FUNCIONARIO VALUES (0004,0002,'352.356.018-74','Ian Antonio Augusto Melo','SP','VOTORANTIM','Jardim Antônio Rodrigues e Rodrigues','Rua Mariana de Andrade Tavuencas',2,'18111-400','R$2.000.00')
INSERT INTO FUNCIONARIO VALUES (0005,0001,'112.455.823-30','Kamilly Renata Amanda das Neves','SP','SOROCABA','Jardim Zulmira','Rua Zilda Cristina de Lima',152,'18061-125','R$4.500.00')

INSERT INTO CLIENTE VALUES (0001,0001,0001,'263.783.574-55','Stefany Agatha Ester Ramos','SP','SOROCABA','Vila Santa Rita','Rua Domingos Angelotti',300,'18080-085')
INSERT INTO CLIENTE VALUES (0002,0004,0003,'543.548.800-16','Camila Alessandra Silveira','SP','TATUI','Jardim Europa','Rua Oswaldo Oliveira',130,'18279-200')
INSERT INTO CLIENTE VALUES (0003,0005,0002,'708.029.888-14','Hadassa Eloá da Costa','SP','ITU','Jardim Theodora','Alameda Santa Cláúdia',111,'13301-863')
INSERT INTO CLIENTE VALUES (0004,0002,0004,'822.612.249-07','Manuela Betina Emilly Castro','SP','VOTORANTIM','Jardim União','Rua José Meira',111,'18115-740')
INSERT INTO CLIENTE VALUES (0005,0003,0005,'365.534.061-38','Augusto Nicolas da Mata','SP','PIEDADE','Centro','Avenida General Waldomiro de Lima',117,'18170-970')

INSERT INTO CONTA VALUES (0001,0001,'R$30.000.00')
INSERT INTO CONTA VALUES (0002,0002,'R$1.00')
INSERT INTO CONTA VALUES (0003,0003,'R$200.00')
INSERT INTO CONTA VALUES (0004,0004,'R$1.00')
INSERT INTO CONTA VALUES (0005,0005,'R$15.00')
INSERT INTO CONTA VALUES (0006,0004,'R$1000')

INSERT INTO TRANSACAO VALUES (0001,0005,'30-06-2020','R$ 30.00')
INSERT INTO TRANSACAO VALUES (0002,0004,'10-10-2021','R$ 25.00')
INSERT INTO TRANSACAO VALUES (0003,0003,'15-01-2023','R$ 300.00')
INSERT INTO TRANSACAO VALUES (0004,0002,'15-01-2023','R$ 5.00')
INSERT INTO TRANSACAO VALUES (0005,0001,'31-01-2020','R$ 45.00')

-- 1 DQL
SELECT ID_FUNCIONARIO, NOME, SALARIO
FROM FUNCIONARIO
WHERE SALARIO = (SELECT MAX (SALARIO) FROM FUNCIONARIO)

-- 2 DQL
SELECT ID_CLIENTE, NOME, CIDADE 
FROM CLIENTE 
WHERE CIDADE = 'SOROCABA';


-- 3 DQL
SELECT NUMERO_TRANSACAO, ID_CONTA, VALOR, COUNT(*)
FROM TRANSACAO
WHERE VALOR >='1000'
GROUP BY ID_CONTA, VALOR, NUMERO_TRANSACAO; 


-- 1 DDL

-- 2 DDL 

-- 3 DDL
